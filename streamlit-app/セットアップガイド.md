# オリコン顧客満足度 TOPICSサポートシステム - セットアップガイド

## 概要

このアプリをローカルで起動することで、**未公開データを外部サーバーに送信せず**安全に利用できます。

---

## 動作環境

| 項目 | 要件 |
|------|------|
| OS | Windows 10/11, macOS, Linux |
| Python | 3.10 以上（推奨: 3.12） |
| メモリ | 4GB以上推奨 |
| ネットワーク | オリコンサイトへのアクセス（スクレイピング用） |

---

## セットアップ手順

### 1. Pythonのインストール

Pythonがインストールされていない場合：

1. [Python公式サイト](https://www.python.org/downloads/) からダウンロード
2. インストール時に **「Add Python to PATH」にチェック**を入れる
3. インストール完了後、コマンドプロンプトで確認：
   ```cmd
   python --version
   ```
   → `Python 3.10.x` 以上が表示されればOK

---

### 2. アプリのダウンロード

GitHubからクローン、またはZIPでダウンロード：

```cmd
git clone https://github.com/TTMK7777/release-creator.git
cd release-creator/streamlit-app
```

または、ZIPファイルを展開して `streamlit-app` フォルダに移動

---

### 3. 必要ライブラリのインストール

コマンドプロンプトで以下を実行：

```cmd
cd streamlit-app
pip install -r requirements.txt
```

#### 必要なライブラリ一覧

| ライブラリ | バージョン | 用途 |
|-----------|-----------|------|
| streamlit | >= 1.28.0 | Webアプリフレームワーク |
| pandas | >= 2.0.0 | データ処理 |
| requests | >= 2.31.0 | HTTP通信 |
| beautifulsoup4 | >= 4.12.0 | HTMLパース（スクレイピング） |
| openpyxl | >= 3.1.0 | Excel読み込み |
| xlsxwriter | >= 3.1.0 | Excel書き出し |
| altair | （streamlitに含まれる） | グラフ描画 |

---

### 4. アプリの起動

```cmd
streamlit run app.py
```

自動的にブラウザが開き、以下のURLでアクセスできます：
- **ローカル**: http://localhost:8501

ポートを変更したい場合：
```cmd
streamlit run app.py --server.port 8505
```

---

## セキュリティについて

### ローカル起動のメリット

| 項目 | ローカル起動 | Streamlit Cloud |
|------|-------------|-----------------|
| データの保存場所 | 自分のPC内のみ | 外部サーバー |
| ネットワーク経由のアクセス | localhost限定 | インターネット公開 |
| 未公開データの安全性 | 高い | 注意が必要 |

### 注意事項

1. **未公開データをアップロードする場合はローカル起動を推奨**
2. アップロードしたファイルはセッション終了時に自動削除されます
3. 同じネットワーク内の他PCからアクセスする場合は `Network URL` を使用

---

## トラブルシューティング

### 「streamlit が認識されません」エラー

```cmd
pip install streamlit
```

または、Pythonのパスが通っていない場合：
```cmd
python -m streamlit run app.py
```

### ポートが使用中のエラー

別のポートを指定：
```cmd
streamlit run app.py --server.port 8510
```

### Excelファイルが読み込めない

`openpyxl` がインストールされているか確認：
```cmd
pip install openpyxl
```

### グラフが表示されない

ブラウザのキャッシュをクリアして再読み込み（Ctrl+Shift+R）

---

## 起動用バッチファイル（Windows）

毎回コマンドを打つのが面倒な場合、以下の内容で `起動.bat` を作成：

```bat
@echo off
cd /d "%~dp0"
streamlit run app.py --server.port 8505
pause
```

ダブルクリックで起動できます。

---

## バージョン情報

- アプリバージョン: 4.1
- 最終更新: 2025-11-27
- 動作確認済みPython: 3.12.10

---

## 問い合わせ

システムに関する質問は開発担当者まで。
