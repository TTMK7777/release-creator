# TOPICS出しアプリ 引継ぎ資料
**作成日**: 2025-11-21

## プロジェクト概要
オリコン顧客満足度ランキングのプレスリリース用TOPICS出しを自動化するStreamlitアプリ

## 完成状況

### 実装済み機能
- [x] 総合ランキング取得（経年対応: 2006年〜）
- [x] 評価項目別ランキング取得（経年対応）
- [x] 部門別ランキング取得（動的発見）
- [x] TOPICS分析（ルールベース）
  - 連続1位分析
  - 得点差分析
  - 項目独占分析
  - 順位変動分析
- [x] 見出し案生成
- [x] 参照URL一覧表示
- [x] デバッグログ機能

### 対応済みランキング
| ランキング名 | URL形式 |
|-------------|---------|
| 携帯キャリア | rank-mobile-carrier |
| 格安SIM | rank-mvno |
| FX | rank_fx |
| 銀行カードローン | rank-card-loan |
| ノンバンクカードローン | rank-card-loan/nonbank |
| ネット証券 | rank_certificate |
| iDeCo証券会社 | rank-ideco |
| 自動車保険 | rank-car-insurance |
| 生命保険 | rank-life-insurance |
| クレジットカード | rank-creditcard |
| 転職サイト | rank-recruit |
| 英会話スクール | rank-english-school |

### URL形式の注意点
- **ハイフン形式**: `rank-xxx` (例: rank-mobile-carrier)
- **アンダースコア形式**: `rank_xxx` (例: rank_fx) → slugに`_`プレフィックス
- **サブパス形式**: `rank-xxx/yyy` (例: rank-card-loan/nonbank)

## ファイル構成
```
streamlit-app/
├── app.py           # メインUI
├── scraper.py       # Webスクレイピング
├── analyzer.py      # TOPICS分析ロジック
└── requirements.txt # 依存パッケージ
```

## 起動方法
```bash
cd "C:\Users\t-tsuji\★AI関連\release-creator\streamlit-app"
streamlit run app.py --server.port 8504
```
ブラウザで http://localhost:8504 にアクセス

## 次回以降の申し送り事項

### 優先度: 高
1. **各社の順位履歴表示機能**
   - 例: 「住信SBIネット銀行 1位6回 2位3回 3位1回」
   - 経年データから各社の順位カウントを集計
   - サマリーテーブルまたは専用タブで表示

### 優先度: 中
2. **Streamlit Cloudデプロイ**
   - GitHubリポジトリ連携
   - 社内共有用URL発行

3. **Word出力機能**
   - テンプレートに沿ったプレスリリース形式
   - python-docxライブラリ使用

### 優先度: 低
4. **AI連携（オプション）**
   - より自然な見出し生成
   - OpenAI/Claude API統合

## 技術メモ

### スクレイピングパターン
- ランキングボックス: `<article class="ranking...">`
- 企業名: `<h3 itemprop="name">`
- 得点: `class="score"`内の数値
- 順位: imgタグのalt属性 or クラス名

### デバッグ方法
アプリ実行時に「🔍 デバッグログ」セクションで以下を確認:
- URL prefix / subpath
- 取得年数・件数
- 評価項目名・部門名

## 依存関係
- streamlit>=1.28.0
- pandas>=2.0.0
- requests>=2.31.0
- beautifulsoup4>=4.12.0

## 担当者メモ
- Windows環境でのUnicodeエラー対応済み（print文をpassに変更）
- 年度範囲は2006年（調査開始年）から選択可能
