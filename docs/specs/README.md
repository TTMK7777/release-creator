# プレスリリース自動生成システム

**オリコン顧客満足度調査プレスリリース作成の完全自動化**

---

## 📖 概要

このプロジェクトは、オリコン顧客満足度調査のプレスリリース作成業務を自動化するVBAツールです。

### 主な機能
- ✅ 元データExcelからリリース用表への自動転記
- ✅ 表のPNG画像化
- ✅ Wordテンプレートへの自動反映
- ✅ **完全オフライン動作**(機密情報保護)

### 処理時間
- **手動:** 1-2時間 → **自動:** 5分以内

---

## 📁 ドキュメント構成

本プロジェクトのドキュメントは以下の3つで構成されています:

### 1. 📋 プレスリリース自動生成_Claude Code引き継ぎ資料.md
**対象者:** プロジェクトマネージャー、企画担当者、Claude Code実装者全員

**内容:**
- プロジェクト概要と目的
- セキュリティ要件(完全オフライン必須)
- ファイル構造の説明
- データフロー図
- 実装仕様の概要
- サンプルコード
- テスト項目
- 展開計画
- トラブルシューティング

**こんな時に読む:**
- プロジェクト全体像を把握したい
- セキュリティ要件を確認したい
- データの流れを理解したい

---

### 2. 🔧 技術仕様書_データ構造とマッピング.md
**対象者:** Claude Code実装者、保守担当者

**内容:**
- 元データExcelの詳細構造(列定義、データ範囲)
- リリース内表Excelの詳細構造
- データマッピング定義(どこから→どこへ)
- 画像生成仕様(範囲、出力形式)
- Word操作仕様(日付更新、タイトル生成ロジック)
- エラーハンドリング方法
- パフォーマンス最適化Tips
- 実際のファイル分析結果に基づく正確な仕様

**こんな時に読む:**
- 実装の詳細を確認したい
- セル範囲やデータ構造を知りたい
- データマッピングのロジックを理解したい

---

### 3. 🚀 Claude Code実装ガイド.md
**対象者:** Claude Code実装者

**内容:**
- クイックスタートガイド
- Phase別の実装タスクリスト
- Task単位のコードテンプレート
- チェックポイント
- テストケース
- デバッグTips
- 完成度チェックリスト

**こんな時に読む:**
- 今すぐ実装を始めたい
- どこから手をつけていいかわからない
- 実装の進捗を確認したい

---

## 🎯 読む順番(推奨)

### 初めての人
1. **README.md** (このファイル) - 5分
2. **Claude Code引き継ぎ資料.md** - 全体把握 - 20分
3. **実装ガイド.md** - 実装開始 - 30分
4. **技術仕様書.md** - 詳細確認(必要に応じて) - 適宜参照

### 実装を始める人
1. **実装ガイド.md** - タスクリスト確認
2. **技術仕様書.md** - 必要な仕様を参照
3. **Claude Code引き継ぎ資料.md** - 不明点があれば確認

### レビューする人
1. **Claude Code引き継ぎ資料.md** - 要件確認
2. **技術仕様書.md** - 実装仕様確認
3. 実装されたVBAコード - コードレビュー

---

## 📂 ファイル一覧

### ドキュメント
```
プロジェクトルート/
├── README.md (このファイル)
├── プレスリリース自動生成_Claude Code引き継ぎ資料.md
├── 技術仕様書_データ構造とマッピング.md
└── Claude Code実装ガイド.md
```

### 入力ファイル(サンプル)
```
プロジェクトルート/
├── _資料_携帯キャリア_ランキング結果2024.xlsx
├── 2025年リフォーム_リリース内表.xlsx
└── 2023年12月発表__携帯キャリア_..._ニュースリリース__.docx
```

### 実装ファイル(作成予定)
```
プロジェクトルート/
├── プレスリリース自動生成.xlsm
│   └── VBAモジュール
│       ├── Module1_Main (メイン制御)
│       ├── Module2_Data (データ処理)
│       ├── Module3_Image (画像生成)
│       ├── Module4_Word (Word操作)
│       └── Module5_Utils (ユーティリティ)
└── output/
    ├── 総合ランキング.png
    ├── 評価項目別ランキング.png
    └── プレスリリース_20251110.docx
```

---

## 🚀 クイックスタート

### ステップ1: 環境準備
1. Windows 10/11
2. Microsoft Excel 2016以降
3. Microsoft Word 2016以降

### ステップ2: 参照設定
1. 新しいExcelファイルを作成
2. `Alt + F11`でVBEを開く
3. ツール > 参照設定
4. 以下をチェック:
   - ☑ Microsoft Excel XX.0 Object Library
   - ☑ Microsoft Word XX.0 Object Library

### ステップ3: 実装開始
「**Claude Code実装ガイド.md**」を開いて、Task 1.1から順番に実装してください。

---

## ⚠️ 重要な注意事項

### セキュリティ
- ❌ **APIへのデータ送信禁止**
- ❌ **インターネット接続禁止**
- ✅ **完全オフライン動作必須**

### 対応範囲
- ✅ Windows環境
- ✅ Excel 2016以降
- ✅ Word 2016以降
- ❌ Mac版Office(未対応)

### データ形式
- 元データExcelの構造が変わった場合は修正が必要
- Wordテンプレートの構造が変わった場合は修正が必要

---

## 📊 実装状況

### Phase 1: 基礎実装
- [ ] メインマクロの骨組み
- [ ] ファイルパス設定
- [ ] ファイル存在チェック

### Phase 2: データ処理
- [ ] 総合ランキング転記
- [ ] 評価項目別転記

### Phase 3: 画像生成
- [ ] 総合ランキング画像化
- [ ] 評価項目別画像化

### Phase 4: Word操作
- [ ] Word起動と基本操作
- [ ] 日付更新
- [ ] タイトル更新
- [ ] 本文更新
- [ ] 画像差し替え

### Phase 5: エラーハンドリング
- [ ] エラーハンドリング実装
- [ ] 統合テスト

---

## 🧪 テスト

### 単体テスト
各関数ごとにテストを実行:
```vba
Sub Test_総合ランキング転記()
    ' テストコード
End Sub
```

### 統合テスト
全工程を通してテスト:
```vba
Sub Test_フルフロー()
    Call プレスリリース自動生成
    ' 結果確認
End Sub
```

### 期待結果
- ✅ 5分以内に完了
- ✅ output/フォルダに3ファイル生成
- ✅ エラーなく完了

---

## 🐛 トラブルシューティング

### Q: 「参照設定エラー」が出る
**A:** VBEのツール > 参照設定で、Microsoft Word Object Libraryにチェックを入れてください。

### Q: 画像が生成されない
**A:** ChartObjectの作成権限を確認。Excelを管理者権限で実行してみてください。

### Q: Wordが開かない
**A:** 既存のWordプロセスを終了してから再実行してください。

詳細は「**Claude Code引き継ぎ資料.md**」の第9章を参照。

---

## 📈 今後の拡張予定

- [ ] 前年データとの自動比較機能
- [ ] 複数調査の一括処理
- [ ] PDFへの自動変換
- [ ] 設定UIの追加
- [ ] 他部署への展開

---

## 📞 連絡先

**プロジェクトオーナー:** たいむ  
**所属:** オリコン / Business Strategy Division  
**役割:** 海外事業開発・新規事業企画・DX推進(AI活用)

---

## 📝 ライセンス

社内利用限定

---

## 📚 参考資料

### Microsoft公式ドキュメント
- [Excel VBA リファレンス](https://docs.microsoft.com/ja-jp/office/vba/api/overview/excel)
- [Word VBA リファレンス](https://docs.microsoft.com/ja-jp/office/vba/api/overview/word)

### VBA学習リソース
- Excel VBA 入門
- Word自動化テクニック

---

**最終更新:** 2025年11月10日  
**バージョン:** 1.0  
**ステータス:** Claude Code実装待ち
