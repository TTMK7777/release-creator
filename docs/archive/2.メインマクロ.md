' =============================================================================

' プレスリリース自動生成マクロ

' 完全オフライン動作 / 機密情報対応

' =============================================================================



Option Explicit



Sub プレスリリース自動生成()

&nbsp;   On Error GoTo ErrorHandler

&nbsp;   

&nbsp;   Dim startTime As Double

&nbsp;   startTime = Timer

&nbsp;   

&nbsp;   Application.ScreenUpdating = False

&nbsp;   Application.DisplayAlerts = False

&nbsp;   

&nbsp;   ' ====================

&nbsp;   ' 【設定】ファイルパス

&nbsp;   ' ====================

&nbsp;   Dim 元データPath As String

&nbsp;   Dim リリース表Path As String

&nbsp;   Dim テンプレートPath As String

&nbsp;   Dim 出力フォルダPath As String

&nbsp;   

&nbsp;   ' ※実際のパスに変更してください

&nbsp;   元データPath = ThisWorkbook.Path \& "\\\_資料\_携帯キャリア\_ランキング結果2024.xlsx"

&nbsp;   リリース表Path = ThisWorkbook.Path \& "\\リリース内表.xlsx"

&nbsp;   テンプレートPath = ThisWorkbook.Path \& "\\テンプレート.docx"

&nbsp;   出力フォルダPath = ThisWorkbook.Path \& "\\output\\"

&nbsp;   

&nbsp;   ' 出力フォルダ作成

&nbsp;   If Dir(出力フォルダPath, vbDirectory) = "" Then

&nbsp;       MkDir 出力フォルダPath

&nbsp;   End If

&nbsp;   

&nbsp;   ' ====================

&nbsp;   ' 実行

&nbsp;   ' ====================

&nbsp;   Debug.Print "========================================="

&nbsp;   Debug.Print "プレスリリース自動生成 開始"

&nbsp;   Debug.Print "========================================="

&nbsp;   

&nbsp;   ' 1. データ転記

&nbsp;   Debug.Print "ステップ1: 元データ → リリース表 転記中..."

&nbsp;   Call データ転記(元データPath, リリース表Path)

&nbsp;   Debug.Print "✓ 転記完了"

&nbsp;   

&nbsp;   ' 2. 画像生成

&nbsp;   Debug.Print vbNewLine \& "ステップ2: 表を画像化中..."

&nbsp;   Call 表を画像化(リリース表Path, 出力フォルダPath)

&nbsp;   Debug.Print "✓ 画像生成完了"

&nbsp;   

&nbsp;   ' 3. Word生成

&nbsp;   Debug.Print vbNewLine \& "ステップ3: プレスリリース作成中..."

&nbsp;   Call Word生成(テンプレートPath, 出力フォルダPath, リリース表Path)

&nbsp;   Debug.Print "✓ Word生成完了"

&nbsp;   

&nbsp;   Application.ScreenUpdating = True

&nbsp;   Application.DisplayAlerts = True

&nbsp;   

&nbsp;   Dim endTime As Double

&nbsp;   endTime = Timer

&nbsp;   

&nbsp;   Debug.Print vbNewLine \& "========================================="

&nbsp;   Debug.Print "✅ 処理完了!"

&nbsp;   Debug.Print "実行時間: " \& Format((endTime - startTime), "0.00") \& "秒"

&nbsp;   Debug.Print "========================================="

&nbsp;   

&nbsp;   MsgBox "プレスリリースの生成が完了しました!" \& vbNewLine \& \_

&nbsp;          "出力先: " \& 出力フォルダPath, vbInformation

&nbsp;   

&nbsp;   Exit Sub

&nbsp;   

ErrorHandler:

&nbsp;   Application.ScreenUpdating = True

&nbsp;   Application.DisplayAlerts = True

&nbsp;   MsgBox "エラーが発生しました: " \& Err.Description, vbCritical

End Sub

