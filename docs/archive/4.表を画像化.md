' =============================================================================

' Excel表 → PNG画像生成

' =============================================================================



Sub 表を画像化(リリース表Path As String, 出力フォルダPath As String)

&nbsp;   

&nbsp;   Dim wb As Workbook

&nbsp;   Dim ws As Worksheet

&nbsp;   Dim rng As Range

&nbsp;   Dim cht As ChartObject

&nbsp;   

&nbsp;   Set wb = Workbooks.Open(リリース表Path, ReadOnly:=True)

&nbsp;   

&nbsp;   ' ---------------------------------------

&nbsp;   ' 総合ランキング表を画像化

&nbsp;   ' ---------------------------------------

&nbsp;   Set ws = wb.Worksheets("総合3つ")

&nbsp;   

&nbsp;   ' 表範囲を選択(実際の範囲に合わせて調整)

&nbsp;   Set rng = ws.Range("B7:D20")

&nbsp;   

&nbsp;   ' 一時的にChartとして作成して画像出力

&nbsp;   rng.CopyPicture Appearance:=xlScreen, Format:=xlPicture

&nbsp;   

&nbsp;   ' 新しいChartObjectを作成

&nbsp;   Set cht = ws.ChartObjects.Add(Left:=rng.Left, Top:=rng.Top, \_

&nbsp;                                  Width:=rng.Width, Height:=rng.Height)

&nbsp;   

&nbsp;   With cht.Chart

&nbsp;       .Paste

&nbsp;       .Export Filename:=出力フォルダPath \& "総合ランキング.png", FilterName:="PNG"

&nbsp;   End With

&nbsp;   

&nbsp;   cht.Delete

&nbsp;   

&nbsp;   ' ---------------------------------------

&nbsp;   ' 評価項目別表を画像化

&nbsp;   ' ---------------------------------------

&nbsp;   Set ws = wb.Worksheets("フルリフォーム 評価項目別")

&nbsp;   Set rng = ws.Range("B8:X30") ' 実際の範囲に調整

&nbsp;   

&nbsp;   rng.CopyPicture Appearance:=xlScreen, Format:=xlPicture

&nbsp;   

&nbsp;   Set cht = ws.ChartObjects.Add(Left:=rng.Left, Top:=rng.Top, \_

&nbsp;                                  Width:=rng.Width, Height:=rng.Height)

&nbsp;   

&nbsp;   With cht.Chart

&nbsp;       .Paste

&nbsp;       .Export Filename:=出力フォルダPath \& "評価項目別ランキング.png", FilterName:="PNG"

&nbsp;   End With

&nbsp;   

&nbsp;   cht.Delete

&nbsp;   

&nbsp;   wb.Close SaveChanges:=False

&nbsp;   Set wb = Nothing

&nbsp;   

End Sub

