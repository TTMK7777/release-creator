' =============================================================================

' 元データExcel → リリース用表Excelへデータ転記

' =============================================================================



Sub データ転記(元DataPath As String, リリース表Path As String)

&nbsp;   

&nbsp;   Dim 元wb As Workbook

&nbsp;   Dim リリースwb As Workbook

&nbsp;   

&nbsp;   ' ファイルオープン

&nbsp;   Set 元wb = Workbooks.Open(元DataPath, ReadOnly:=True)

&nbsp;   Set リリースwb = Workbooks.Open(リリース表Path)

&nbsp;   

&nbsp;   ' ---------------------------------------

&nbsp;   ' 総合ランキングデータ転記

&nbsp;   ' ---------------------------------------

&nbsp;   Dim 元ws As Worksheet

&nbsp;   Dim リリースws As Worksheet

&nbsp;   

&nbsp;   Set 元ws = 元wb.Worksheets("総合対象企業")

&nbsp;   Set リリースws = リリースwb.Worksheets("総合3つ")

&nbsp;   

&nbsp;   ' データ範囲を特定

&nbsp;   Dim lastRow As Long

&nbsp;   lastRow = 元ws.Cells(元ws.Rows.Count, "A").End(xlUp).Row

&nbsp;   

&nbsp;   ' 上位3位を転記(例)

&nbsp;   Dim i As Long

&nbsp;   Dim 転記先Row As Long

&nbsp;   転記先Row = 9 ' リリース表の開始行

&nbsp;   

&nbsp;   For i = 5 To 7 ' 元データの5-7行目(1-3位)

&nbsp;       With リリースws

&nbsp;           .Cells(転記先Row, 2).Value = i - 4 \& "位" ' 順位

&nbsp;           .Cells(転記先Row, 3).Value = 元ws.Cells(i, 3).Value ' サービス名

&nbsp;           .Cells(転記先Row, 4).Value = Round(元ws.Cells(i, 7).Value, 1) ' 得点

&nbsp;       End With

&nbsp;       転記先Row = 転記先Row + 1

&nbsp;   Next i

&nbsp;   

&nbsp;   ' ---------------------------------------

&nbsp;   ' 評価項目別データ転記

&nbsp;   ' ---------------------------------------

&nbsp;   Set 元ws = 元wb.Worksheets("評価項目")

&nbsp;   Set リリースws = リリースwb.Worksheets("フルリフォーム 評価項目別")

&nbsp;   

&nbsp;   ' 評価項目ごとにループ処理

&nbsp;   ' (省略 - 実際のデータ構造に合わせて実装)

&nbsp;   

&nbsp;   ' 保存

&nbsp;   リリースwb.Save

&nbsp;   

&nbsp;   ' クローズ

&nbsp;   元wb.Close SaveChanges:=False

&nbsp;   リリースwb.Close SaveChanges:=True

&nbsp;   

&nbsp;   Set 元wb = Nothing

&nbsp;   Set リリースwb = Nothing

&nbsp;   

End Sub

